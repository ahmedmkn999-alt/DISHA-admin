<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | DISHA ADMIN</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { background: #000; color: white; font-family: 'Cairo'; padding: 0; margin: 0; }
        
        /* Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #loginScreen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .login-box { text-align: center; width: 90%; max-width: 300px; }
        .login-input { width: 100%; padding: 15px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #D4AF37; background: #111; color: white; font-size: 1.2rem; text-align: center; }
        
        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        #dashboard { display: none; padding: 20px; max-width: 600px; margin: 0 auto; }
        
        /* Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¹Ø§Ù…Ø© */
        input, select, button { width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 5px; border: none; font-size: 1rem; box-sizing: border-box; }
        input, select { background: #222; color: white; border: 1px solid #444; }
        button { background: #D4AF37; color: black; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { background: #F4CF57; }
        
        .product-item { background: #151515; padding: 15px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #333; display: flex; justify-content: space-between; align-items: center; }
        .del-btn { background: #c00; color: white; width: auto; padding: 5px 15px; margin: 0; }
        
        h2 { color: #D4AF37; border-bottom: 2px solid #D4AF37; padding-bottom: 10px; margin-top: 30px; }
        .status { text-align: center; margin-bottom: 20px; color: #777; font-size: 0.9rem; }
    </style>
</head>
<body>

    <div id="loginScreen">
        <div class="login-box">
            <h2 style="border:none;">ğŸ” DISHA ADMIN</h2>
            <input type="password" id="passInput" class="login-input" placeholder="Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
            <button onclick="checkPass()">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>

    <div id="dashboard">
        <h3 style="text-align: center; color: #D4AF37;">Ø£Ù‡Ù„Ø§Ù‹ ÙŠØ§ Ù‡Ù†Ø¯Ø³Ø© ğŸ‘‹</h3>
        <p class="status">Ù…ØªØµÙ„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª: disha-brand</p>

        <h2>â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h2>
        <input type="text" id="pName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ (Ù…Ø«Ø§Ù„: Hoodie Black)">
        <input type="number" id="pPrice" placeholder="Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ (Ù…Ø«Ø§Ù„: 600)">
        <input type="number" id="pOld" placeholder="Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
        
        <select id="pType">
            <option value="top">Ù‡ÙˆØ¯ÙŠ / Ø³ÙˆÙŠØª Ø´ÙŠØ±Øª (Top)</option>
            <option value="bottom">Ø¨Ù†Ø·Ù„ÙˆÙ† (Pants)</option>
            <option value="track">ØªØ±Ù†Ø¬ ÙƒØ§Ù…Ù„ (Tracksuit)</option>
        </select>
        
        <input type="text" id="pImgF" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„ÙˆØ´">
        <input type="text" id="pImgB" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ø¶Ù‡Ø± (Ù„Ùˆ Ù…ÙÙŠØ´ ÙƒØ±Ø± Ø§Ù„ÙˆØ´)">
        
        <button id="addBtn">Ù†Ø´Ø± Ø§Ù„Ù…Ù†ØªØ¬</button>

        <h2>ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© (<span id="count">0</span>)</h2>
        <button onclick="window.location.reload()" style="background:#333; color:white;">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ğŸ”„</button>
        <div id="productsList">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        
        <br><br>
        <button onclick="logout()" style="background:#c00; color:white;">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ ğŸ”’</button>
    </div>

    <script type="module">
        // ğŸ”¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…ÙƒØªØ¨Ø§Øª ÙØ§ÙŠØ±Ø¨ÙŠØ³
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, orderBy, query } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // ğŸ”¥ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø®Ø§ØµØ© Ø¨ÙŠÙƒ (Ø£Ù†Øª Ø¨Ø¹ØªÙ‡Ø§)
        const firebaseConfig = {
            apiKey: "AIzaSyAQuVtULU8APTurAmlkQ9gNyFG_N1Jvq48",
            authDomain: "disha-brand.firebaseapp.com",
            projectId: "disha-brand",
            storageBucket: "disha-brand.firebasestorage.app",
            messagingSenderId: "170505241014",
            appId: "1:170505241014:web:b3cbea5dcb06624e93c117",
            measurementId: "G-XL3C1JY6MF"
        };

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // ğŸ” Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ù…Ø§ÙŠØ© (Password System)
        window.checkPass = function() {
            const pass = document.getElementById('passInput').value;
            if (pass === "0112838") {
                localStorage.setItem("dishaAdminAuth", "true");
                showDashboard();
            } else {
                alert("Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ ØºÙ„Ø· ÙŠØ§ Ø±ÙŠØ³! âŒ");
            }
        }

        function showDashboard() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            loadProducts(); // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ù…Ø§ ÙŠØ¯Ø®Ù„
        }

        window.logout = function() {
            localStorage.removeItem("dishaAdminAuth");
            location.reload();
        }

        // Ù„Ùˆ ÙƒØ§Ù† Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ù‚Ø¨Ù„ ÙƒØ¯Ù‡ ÙŠØ¯Ø®Ù„Ù‡ Ø¹Ù„Ø·ÙˆÙ„
        if (localStorage.getItem("dishaAdminAuth") === "true") {
            showDashboard();
        }

        // â• 1. ÙƒÙˆØ¯ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬
        document.getElementById('addBtn').addEventListener('click', async () => {
            const btn = document.getElementById('addBtn');
            const n = document.getElementById('pName').value;
            const p = document.getElementById('pPrice').value;
            const o = document.getElementById('pOld').value || 0;
            const t = document.getElementById('pType').value;
            const f = document.getElementById('pImgF').value;
            const b = document.getElementById('pImgB').value;

            if(!n || !p || !f) { alert("Ù†Ø§Ù‚Øµ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù‡Ù…Ø© (Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ø³Ø¹Ø±ØŒ Ø§Ù„ØµÙˆØ±Ø©)!"); return; }

            btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ø´Ø±...";
            btn.disabled = true;

            try {
                await addDoc(collection(db, "products"), {
                    n: n, 
                    p: Number(p), 
                    o: Number(o), 
                    t: t, 
                    f: f, 
                    b: b || f, // Ù„Ùˆ Ù…ÙÙŠØ´ ØµÙˆØ±Ø© Ø¶Ù‡Ø± Ø­Ø· ØµÙˆØ±Ø© Ø§Ù„ÙˆØ´
                    date: Date.now() // Ø¹Ø´Ø§Ù† Ø§Ù„ØªØ±ØªÙŠØ¨ Ø¨Ø§Ù„Ø£Ø­Ø¯Ø«
                });
                alert("ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­! âœ…");
                // ØªÙØ±ÙŠØº Ø§Ù„Ø®Ø§Ù†Ø§Øª
                document.getElementById('pName').value = '';
                document.getElementById('pImgF').value = '';
                document.getElementById('pImgB').value = '';
                loadProducts();
            } catch (e) {
                alert("Ø­ØµÙ„ Ø®Ø·Ø£: " + e.message);
            }
            btn.innerText = "Ù†Ø´Ø± Ø§Ù„Ù…Ù†ØªØ¬";
            btn.disabled = false;
        });

        // ğŸ“‹ 2. Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        async function loadProducts() {
            const list = document.getElementById('productsList');
            list.innerHTML = '<p style="text-align:center; color:#777">Ø¬Ø§Ø±ÙŠ Ø³Ø­Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>';
            
            try {
                // ØªØ±ØªÙŠØ¨ Ø¨Ø§Ù„Ø£Ø­Ø¯Ø« (date desc)
                const q = query(collection(db, "products"), orderBy("date", "desc"));
                const querySnapshot = await getDocs(q);
                
                list.innerHTML = '';
                document.getElementById('count').innerText = querySnapshot.size;

                if (querySnapshot.empty) {
                    list.innerHTML = '<p style="text-align:center;">Ù…ÙÙŠØ´ Ù…Ù†ØªØ¬Ø§Øª Ù„Ø³Ù‡</p>';
                    return;
                }

                querySnapshot.forEach((docSnap) => {
                    const data = docSnap.data();
                    const div = document.createElement('div');
                    div.className = 'product-item';
                    div.innerHTML = `
                        <div style="display:flex; align-items:center; gap:10px;">
                            <img src="${data.f}" style="width:50px; height:50px; object-fit:cover; border-radius:5px;">
                            <div>
                                <div style="font-weight:bold; color:white;">${data.n}</div>
                                <div style="font-size:0.8rem; color:#D4AF37;">${data.p} Ø¬.Ù…</div>
                            </div>
                        </div>
                        <button class="del-btn" onclick="window.deleteProduct('${docSnap.id}')">Ù…Ø³Ø­ ğŸ—‘ï¸</button>
                    `;
                    list.appendChild(div);
                });
            } catch (e) {
                list.innerHTML = '<p style="color:red; text-align:center">ÙÙŠ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„. ØªØ£ÙƒØ¯ Ø¥Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø´ØºØ§Ù„.</p>';
                console.error(e);
            }
        }

        // âŒ 3. Ø­Ø°Ù Ù…Ù†ØªØ¬
        window.deleteProduct = async (id) => {
            if(confirm('Ù…ØªØ£ÙƒØ¯ Ø¥Ù†Ùƒ Ø¹Ø§ÙŠØ² ØªÙ…Ø³Ø­ Ø§Ù„Ù…Ù†ØªØ¬ Ø¯Ù‡ Ù†Ù‡Ø§Ø¦ÙŠØŸ')) {
                try {
                    await deleteDoc(doc(db, "products", id));
                    loadProducts(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                } catch (e) {
                    alert("Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø­Ø°Ù: " + e.message);
                }
            }
        }
    </script>
</body>
  </html>
  
