<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | DISHA ADMIN</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { background: #000; color: white; font-family: 'Cairo'; padding: 0; margin: 0; }
        
        /* Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #loginScreen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .login-box { text-align: center; width: 90%; max-width: 300px; }
        .login-input { width: 100%; padding: 15px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #D4AF37; background: #111; color: white; font-size: 1.2rem; text-align: center; }
        
        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        #dashboard { display: none; padding: 20px; max-width: 600px; margin: 0 auto; padding-bottom: 80px; }
        
        input, select, button { width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 5px; border: none; font-size: 1rem; box-sizing: border-box; }
        input, select { background: #222; color: white; border: 1px solid #444; }
        button { background: #D4AF37; color: black; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { background: #F4CF57; }
        
        /* Ø²Ø±Ø§Ø± Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ */
        .magic-btn { background: linear-gradient(45deg, #00c6ff, #0072ff); color: white; border: 1px solid #fff; margin-bottom: 20px; }

        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .product-item { background: #151515; padding: 10px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #333; display: flex; justify-content: space-between; align-items: center; cursor: pointer; transition: 0.2s; }
        .product-item:hover { background: #222; border-color: #D4AF37; }
        
        h2 { color: #D4AF37; border-bottom: 2px solid #D4AF37; padding-bottom: 10px; margin-top: 30px; }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ */
        .edit-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 10000; display: none; justify-content: center; align-items: center; }
        .edit-box { background: #111; padding: 20px; width: 90%; max-width: 400px; border-radius: 10px; border: 1px solid #D4AF37; max-height: 90vh; overflow-y: auto; }
        .edit-img-preview { width: 100px; height: 100px; object-fit: cover; border-radius: 5px; margin: 0 auto 10px auto; display: block; border: 1px solid #555; }
        .close-btn { background: transparent; color: #ccc; border: 1px solid #555; margin-top: 5px; }
    </style>
</head>
<body>

    <div id="loginScreen">
        <div class="login-box">
            <h2 style="border:none;">ğŸ” DISHA ADMIN</h2>
            <input type="password" id="passInput" class="login-input" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
            <button onclick="checkPass()">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>

    <div id="dashboard">
        <h3 style="text-align: center; color: #D4AF37;">Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© âš™ï¸</h3>

        <div style="background:#111; padding:15px; border:1px solid #333; border-radius:10px; margin-bottom:20px; text-align:center;">
            <h4 style="margin:0 0 10px 0; color:#00c6ff;">Ù†Ù‚Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©</h4>
            <p style="font-size:0.8rem; color:#ccc;">Ø¯ÙˆØ³ Ù‡Ù†Ø§ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ø´Ø§Ù† ØªØ±ÙØ¹ Ø§Ù„Ù€ 22 Ù…Ù†ØªØ¬ Ù„Ù„ÙˆØ­Ø© ÙˆØªØªØ­ÙƒÙ… ÙÙŠÙ‡Ù…</p>
            <button class="magic-btn" onclick="importAll()" id="impBtn">ğŸš€ Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø¢Ù†</button>
        </div>

        <h2>â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</h2>
        <input type="text" id="pName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
        <div style="display:flex; gap:5px;">
            <input type="number" id="pPrice" placeholder="Ø§Ù„Ø³Ø¹Ø±">
            <input type="number" id="pOld" placeholder="Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ…">
        </div>
        <select id="pType">
            <option value="top">Ù‡ÙˆØ¯ÙŠ (Top)</option>
            <option value="bottom">Ø¨Ù†Ø·Ù„ÙˆÙ† (Bottom)</option>
            <option value="track">ØªØ±Ù†Ø¬ (Track)</option>
        </select>
        <input type="text" id="pImgF" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆØ´">
        <input type="text" id="pImgB" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø¶Ù‡Ø±">
        <button id="addBtn">Ù†Ø´Ø± Ø§Ù„Ù…Ù†ØªØ¬</button>

        <h2>ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (<span id="count">0</span>)</h2>
        <p style="font-size:0.8rem; color:#888; text-align:center;">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ù…Ù†ØªØ¬ Ù„ØªØ¹Ø¯ÙŠÙ„Ù‡ Ø£Ùˆ Ù…Ø³Ø­Ù‡ ğŸ‘‡</p>
        <div id="productsList">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        
        <br>
        <button onclick="logout()" style="background:#c00; color:white;">Ø®Ø±ÙˆØ¬</button>
    </div>

    <div id="editModal" class="edit-modal">
        <div class="edit-box">
            <h3 style="text-align:center; color:#D4AF37; margin-top:0;">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ âœï¸</h3>
            
            <img id="ePreview" class="edit-img-preview" src="">
            
            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬:</label>
            <input type="text" id="eName">
            
            <div style="display:flex; gap:5px;">
                <div style="width:50%"><label>Ø§Ù„Ø³Ø¹Ø±:</label><input type="number" id="ePrice"></div>
                <div style="width:50%"><label>Ù‚Ø¯ÙŠÙ…:</label><input type="number" id="eOld"></div>
            </div>

            <label>Ø§Ù„Ù†ÙˆØ¹:</label>
            <select id="eType">
                <option value="top">Ù‡ÙˆØ¯ÙŠ</option>
                <option value="bottom">Ø¨Ù†Ø·Ù„ÙˆÙ†</option>
                <option value="track">ØªØ±Ù†Ø¬</option>
            </select>

            <label>Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (Ø§Ù„ÙˆØ´):</label>
            <input type="text" id="eImgF" onchange="document.getElementById('ePreview').src=this.value">
            
            <label>Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (Ø§Ù„Ø¶Ù‡Ø±):</label>
            <input type="text" id="eImgB">

            <button onclick="saveEdit()" style="background:#25D366; color:white;">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª âœ…</button>
            <button onclick="deleteCurrent()" style="background:#c00; color:white;">Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ ğŸ—‘ï¸</button>
            <button onclick="closeEdit()" class="close-btn">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, updateDoc, orderBy, query } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙØ§ÙŠØ±Ø¨ÙŠØ³
        const firebaseConfig = {
            apiKey: "AIzaSyAQuVtULU8APTurAmlkQ9gNyFG_N1Jvq48",
            authDomain: "disha-brand.firebaseapp.com",
            projectId: "disha-brand",
            storageBucket: "disha-brand.firebasestorage.app",
            messagingSenderId: "170505241014",
            appId: "1:170505241014:web:b3cbea5dcb06624e93c117",
            measurementId: "G-XL3C1JY6MF"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Ø§Ù„Ø¯Ø§ØªØ§ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© (Ù„Ù„Ù†Ù‚Ù„)
        const oldData = [
            {n:'Hoodie Skull Black', p:600, o:750, t:'top', f:'https://i.postimg.cc/5tmyCWVq/ddf7ab69bd3b4107acc21fe160cecc8e.jpg', b:'https://i.postimg.cc/jjh27Ybc/6e9c779330a243aa9726ab1264d436b7.jpg'},
            {n:'Sweatshirt Basic White', p:650, o:800, t:'top', f:'https://i.postimg.cc/ydYdhp1j/81b107ef7281417dad506780ee8cdd5d.jpg', b:'https://i.postimg.cc/ydYdhp1j/81b107ef7281417dad506780ee8cdd5d.jpg'},
            {n:'Hoodie Graphic Off-White', p:600, o:750, t:'top', f:'https://i.postimg.cc/MGYHQJSD/913fce38965c45a6a297f01e01ddd50b.jpg', b:'https://i.postimg.cc/25xyZND0/acbeec02f32e4d6eb68a1c323fed0dda.jpg'},
            {n:'Sweatshirt Basic Grey', p:650, o:800, t:'top', f:'https://i.postimg.cc/0Q2QGXkf/c603bcbcda67413a83ebcffb745fd8d1.jpg', b:'https://i.postimg.cc/0Q2QGXkf/c603bcbcda67413a83ebcffb745fd8d1.jpg'},
            {n:'Sweatshirt Basic Black', p:650, o:800, t:'top', f:'https://i.postimg.cc/N0xFHvcb/ef64e6c8b8fe4c388e355eaf81ca510d.jpg', b:'https://i.postimg.cc/N0xFHvcb/ef64e6c8b8fe4c388e355eaf81ca510d.jpg'},
            {n:'Premium Sweatshirt Black', p:800, o:1000, t:'top', f:'https://i.postimg.cc/3w9pHvdY/fdf4556fed264436ad7d20d231c3c0ff.jpg', b:'https://i.postimg.cc/hjjm4t7H/b99d7c0aa746486eb9e54f8e1e309cef.jpg'},
            {n:'Hoodie Shine', p:600, o:750, t:'top', f:'https://i.postimg.cc/Xv0Xy5Qj/1000012716.jpg', b:'https://i.postimg.cc/GmR2gq4P/1000012717.jpg'},
            {n:'Tracksuit Full Set Black', p:900, o:1000, t:'track', f:'https://i.postimg.cc/TPhmfPmd/d42e2e329d3e4c049e3e0c887dce5463.jpg', b:'https://i.postimg.cc/TPhmfPmd/d42e2e329d3e4c049e3e0c887dce5463.jpg'},
            {n:'Tracksuit Full Set Grey', p:900, o:1000, t:'track', f:'https://i.postimg.cc/pdy8Rd8d/eccd0f68a93241ed84eda8827c2bba92.jpg', b:'https://i.postimg.cc/pdy8Rd8d/eccd0f68a93241ed84eda8827c2bba92.jpg'},
            {n:'High-End Sweatshirt Set', p:1300, o:1500, t:'track', f:'https://i.postimg.cc/bvdbpvbN/ff9b3cbaab694db8bcf404a4c3c63868.jpg', b:'https://i.postimg.cc/bvdbpvbN/ff9b3cbaab694db8bcf404a4c3c63868.jpg'},
            {n:'Premium Sweatshirt Set Beige', p:800, o:1000, t:'track', f:'https://i.postimg.cc/xdqHndH8/a31bad4a4c794a1ba0098a7fd72eb982.jpg', b:'https://i.postimg.cc/xdqHndH8/a31bad4a4c794a1ba0098a7fd72eb982.jpg'},
            {n:'Cargo Pants', p:700, o:800, t:'bottom', f:'https://i.postimg.cc/SK0qNTYx/69f03da0d15e42ce878cd7818fa0b75f.jpg', b:'https://i.postimg.cc/SK0qNTYx/69f03da0d15e42ce878cd7818fa0b75f.jpg'},
            {n:'Jeans Light Blue', p:600, o:750, t:'bottom', f:'https://i.postimg.cc/zByvgp1V/IMG_20260210_WA0023.jpg', b:'https://i.postimg.cc/j5D27vrD/IMG_20260210_WA0022.jpg'},
            {n:'Jeans Mod 1', p:600, o:750, t:'bottom', f:'https://i.postimg.cc/TPzMtcWZ/IMG_20260211_WA0000.jpg', b:'https://i.postimg.cc/TPzMtcWZ/IMG_20260211_WA0000.jpg'},
            {n:'Jeans Mod 2', p:600, o:750, t:'bottom', f:'https://i.postimg.cc/d0kcRfLP/IMG_20260211_WA0001.jpg', b:'https://i.postimg.cc/d0kcRfLP/IMG_20260211_WA0001.jpg'},
            {n:'Jeans Mod 3', p:600, o:750, t:'bottom', f:'https://i.postimg.cc/8C2QZbr3/IMG_20260211_WA0002.jpg', b:'https://i.postimg.cc/8C2QZbr3/IMG_20260211_WA0002.jpg'},
            {n:'Jeans Mod 4', p:600, o:750, t:'bottom', f:'https://i.postimg.cc/bv7cmR24/IMG_20260211_WA0003.jpg', b:'https://i.postimg.cc/bv7cmR24/IMG_20260211_WA0003.jpg'},
            {n:'Jeans Mod 5', p:600, o:750, t:'bottom', f:'https://i.postimg.cc/XJb1Z15q/IMG_20260211_WA0004.jpg', b:'https://i.postimg.cc/Kz2pKpTR/IMG_20260211_WA0005.jpg'}
        ];

        let allProducts = [];
        let currentEditId = null;

        window.checkPass = function() {
            if (document.getElementById('passInput').value === "0112838") {
                localStorage.setItem("dishaAdmin", "true");
                showDash();
            } else alert("Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ ØºÙ„Ø·!");
        }
        function showDash() {
            document.getElementById('loginScreen').style.display='none';
            document.getElementById('dashboard').style.display='block';
            loadProducts();
        }
        if(localStorage.getItem("dishaAdmin")) showDash();
        window.logout = function() { localStorage.removeItem("dishaAdmin"); location.reload(); }

        // ğŸš€ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
        window.importAll = async () => {
            if(!confirm("Ø¬Ø§Ù‡Ø² ØªØ±ÙØ¹ Ø§Ù„Ù€ 22 Ù…Ù†ØªØ¬ Ù„Ù„ÙˆØ­Ø©ØŸ")) return;
            const btn = document.getElementById('impBtn');
            btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹... â³"; btn.disabled=true;
            let c=0;
            for (let i of oldData) {
                try {
                    await addDoc(collection(db, "products"), {
                        n: i.n, p: Number(i.p), o: Number(i.o), t: i.t, f: i.f, b: i.b||i.f, date: Date.now()+c
                    }); c++;
                } catch(e) {}
            }
            alert(`ØªÙ… Ø±ÙØ¹ ${c} Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­!`); location.reload();
        }

        // â• Ø¥Ø¶Ø§ÙØ©
        document.getElementById('addBtn').addEventListener('click', async () => {
            const n=document.getElementById('pName').value, p=document.getElementById('pPrice').value, f=document.getElementById('pImgF').value;
            if(!n||!p||!f) { alert("ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!"); return; }
            document.getElementById('addBtn').innerText="Ø¬Ø§Ø±ÙŠ...";
            await addDoc(collection(db, "products"), {
                n, p:Number(p), o:Number(document.getElementById('pOld').value||0),
                t:document.getElementById('pType').value, f, b:document.getElementById('pImgB').value||f, date:Date.now()
            });
            alert("ØªÙ…!"); document.getElementById('addBtn').innerText="Ù†Ø´Ø± Ø§Ù„Ù…Ù†ØªØ¬";
            document.getElementById('pName').value=''; loadProducts();
        });

        // ğŸ“‹ Ø¹Ø±Ø¶
        async function loadProducts() {
            const list = document.getElementById('productsList');
            list.innerHTML = '<p style="text-align:center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>';
            const q = query(collection(db, "products"), orderBy("date", "desc"));
            const snap = await getDocs(q);
            allProducts = []; list.innerHTML = '';
            document.getElementById('count').innerText = snap.size;
            
            snap.forEach(d => {
                const data = d.data(); data.id = d.id; allProducts.push(data);
                list.innerHTML += `
                    <div class="product-item" onclick="window.openEdit('${d.id}')">
                        <div style="display:flex; align-items:center; gap:10px;">
                            <img src="${data.f}" style="width:40px; height:40px; border-radius:5px;">
                            <div><b>${data.n}</b><br><span style="color:#D4AF37">${data.p} Ø¬.Ù…</span></div>
                        </div>
                        <div style="font-size:1.2rem;">âœï¸</div>
                    </div>`;
            });
        }

        // âœï¸ ØªØ¹Ø¯ÙŠÙ„
        window.openEdit = (id) => {
            const p = allProducts.find(x => x.id === id);
            if(!p) return;
            currentEditId = id;
            document.getElementById('eName').value = p.n;
            document.getElementById('ePrice').value = p.p;
            document.getElementById('eOld').value = p.o||'';
            document.getElementById('eType').value = p.t;
            document.getElementById('eImgF').value = p.f;
            document.getElementById('eImgB').value = p.b||'';
            document.getElementById('ePreview').src = p.f;
            document.getElementById('editModal').style.display = 'flex';
        }

        window.saveEdit = async () => {
            if(!currentEditId) return;
            const n=document.getElementById('eName').value, p=document.getElementById('ePrice').value;
            await updateDoc(doc(db, "products", currentEditId), {
                n, p:Number(p), o:Number(document.getElementById('eOld').value||0),
                t:document.getElementById('eType').value,
                f:document.getElementById('eImgF').value,
                b:document.getElementById('eImgB').value
            });
            alert("ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„!"); closeEdit(); loadProducts();
        }

        window.deleteCurrent = async () => {
            if(confirm("Ù…Ø³Ø­ Ù†Ù‡Ø§Ø¦ÙŠØŸ")) {
                await deleteDoc(doc(db, "products", currentEditId));
                alert("ØªÙ… Ø§Ù„Ø­Ø°Ù"); closeEdit(); loadProducts();
            }
        }
        window.closeEdit = () => { document.getElementById('editModal').style.display='none'; }
    </script>
</body>
</html>
